# Task 1631 â€” ZozoBet 7 Upgrades

## Status: âœ… All 7 tasks complete

### Changes Made:

**Task 1: Admin Impersonate** âœ…
- Added `POST /api/admin/users/:id/impersonate` endpoint (admin only) - generates JWT for target user
- Added ğŸ‘¤ button in admin panel user list â†’ sets cookie and redirects to main site as that user

**Task 2: Suspend User** âœ…
- Added `active` field to User model (default: true)
- Added `POST /api/admin/users/:id/suspend` endpoint
- Login blocks with "×”×—×©×‘×•×Ÿ ×©×œ×š ××•×©×”×”" when active=false
- Admin panel shows â¸ï¸ button and "××•×©×”×”" status

**Task 3: More Sports & Leagues** âœ…
- Aggregator priority list expanded: tennis (ATP slams), basketball (NBA, EuroLeague, NCAAB), baseball (MLB), hockey (NHL), MMA, cricket (ICC, IPL, T20)
- Increased fetch limit from 8 to 20 sports

**Task 4: Hebrew Language + RTL** âœ…
- Full i18n system with HE/EN translations (I18N object with ~50 keys)
- Language toggle button (EN/HE) in header
- `dir=rtl/ltr` toggles on html element
- localStorage persistence for language choice
- `updateUILang()` updates all static UI text

**Task 5: Agent Can't Bet** âœ…
- Backend: bets.js returns 403 "×¡×•×›× ×™× ×œ× ×™×›×•×œ×™× ×œ×”××¨" for role=agent
- Frontend: `addS()` blocks with toast for agents, bet slip hidden for agent role

**Task 6: Agent Panel** âœ…
- New `/agent.html` page accessible to agents
- Features: create player (username, password, displayName), list own players, delete player, change password
- NO credit/points management buttons
- Added `POST /api/admin/users/:id/password` endpoint
- Agent link shown in header nav for agent users

**Task 7: Success/Failure Toast** âœ…
- Both `placeBet()` and `placeBetPop()` show detailed toast:
  - Success: "×”×”×™××•×¨ ×‘×•×¦×¢ ×‘×”×¦×œ×—×” âœ…" + stake Ã— odds = potential win
  - Failure: "×”×”×™××•×¨ × ×›×©×œ âŒ" + error message
- Toast CSS updated for multiline, centered, max-width

### Files Modified:
- `backend/src/models/User.js` â€” added `active`, `displayName` fields
- `backend/src/routes/auth.js` â€” active check on login
- `backend/src/routes/admin.js` â€” impersonate, suspend, password endpoints
- `backend/src/routes/bets.js` â€” agent block
- `backend/src/middleware/auth.js` â€” (no change, generateToken already exported)
- `backend/public/admin.html` â€” impersonate/suspend buttons
- `backend/public/index.html` â€” i18n, lang toggle, agent restrictions, toast
- `backend/public/agent.html` â€” NEW agent panel
- `aggregator/src/index.js` â€” expanded sports list
