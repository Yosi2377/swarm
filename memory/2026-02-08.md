# 2026-02-08 - Blackjack Game Session

## Current State
- **URL**: https://zozoblackjeck.duckdns.org
- **Fallback**: http://95.111.247.22:3000
- **Path**: `/root/Blackjack-Game-Multiplayer/`
- **Service**: `systemctl restart blackjack`, port 3000
- **Auth**: admin/admin123, test2/test123

## HTTPS
- nginx reverse proxy 80/443 â†’ localhost:3000
- Let's Encrypt cert via DuckDNS: zozoblackjeck.duckdns.org
- DuckDNS token: `18528b55-8ebc-4658-ade1-9babbabe2e6f`
- nginx config: `/etc/nginx/sites-available/blackjack`

## UI Summary
- Premium casino theme: dark navy + gold
- 5 player seats on arc, 3D perspective on all cards
- Card back: casino red SVG with gold spade medallion
- Table decorations: card shoe + dealer chip stacks
- Action buttons: HIT(green) STAND(red) DOUBLE(gold) SPLIT(blue)
- Chips: ImageMagick 200x200 squares, 40px buttons
- Login page: Playfair Display font, glass card, Gemini AI background
- Lobby: premium user card, room list with LIVE/OPEN badges, admin delete

## Features
- Split (compares numeric values), game persistence on refresh, no double-join
- Persistent rooms (admin delete only), gzip compression
- Admin panel: /admin/dashboard.html

## Open Bug: 2-Player Sync
- Fixed `if (!game.gameOn === true)` operator precedence bug in index.js
- Added player sync in client.js "update" handler
- **Still needs real testing** - P2 had 0 cards in automated tests
- Root cause: game logic is client-side (app.js), server just broadcasts
- May need deeper fix for proper multiplayer sync

## Key Files
- index.js: server, WebSocket, auth, rooms
- public/js/client.js: WS client, room list, updates
- public/js/app.js: game logic, split, deal, cards
- public/css/custom-theme.css: ~1250 lines, mobile styles
- public/imgs/custom/: table, chips, login bg
- public/imgs/Card_back_premium.svg: card back

## Lessons
- iPhone safe area ~34px, iOS blocks self-signed certs
- DuckDNS for free custom domain names with Let's Encrypt
- `!x === true` != `!(x === true)` - operator precedence!
- Model pre-save hooks double-hash if you hash before create
