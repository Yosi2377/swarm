# Task 1836 — 14 Markets for ZozoBet

## Status: ✅ Complete

## Changes Made

### 1. Aggregator (`aggregator/src/index.js`)
- Changed `fetchOdds()` to use per-event endpoint: `GET /v4/sports/{sport}/events/{eventId}/odds`
- First fetches events list (free), then per-event odds (quota cost)
- Limited to 20 events per poll cycle to save quota
- Added `parseAllOdds()` supporting all 14 market types:
  - h2h, h2h_h1, h2h_h2, h2h_lay (1X2 variants)
  - spreads, alternate_spreads
  - totals, totals_h1, totals_h2, alternate_totals
  - btts, double_chance, draw_no_bet, team_totals
- Updated Event schema to `odds: Mixed` (flexible for all markets)
- Boot function also requests btts/double_chance/draw_no_bet on sports-level endpoint

### 2. Backend Event Model (`backend/src/models/Event.js`)
- Changed odds field from strict schema to `mongoose.Schema.Types.Mixed`

### 3. Frontend Modal (`backend/public/live.html`)
- 8 tabs in modal (show only when data exists):
  - **1X2** — h2h + h2h_lay
  - **O/U** — totals + alternate_totals
  - **Spreads** — spreads + alternate_spreads
  - **BTTS** — btts (yes/no)
  - **הזדמנות כפולה** — double_chance
  - **ללא תיקו** — draw_no_bet
  - **מחציות** — h2h_h1, h2h_h2, totals_h1, totals_h2
  - **שערי קבוצה** — team_totals
- Tabs are scrollable horizontally
- Each odd button adds to bet slip with correct market/outcome identifiers

### 4. Settlement (`backend/src/engines/settlement.js`)
- Added settlement logic for: btts, double_chance, draw_no_bet, h2h_h1/h2h_h2, totals_h1/h2, alternate_totals, alternate_spreads, team_totals, h2h_lay
- Half-time markets settle as void (no half-scores from API)
- Lay bets settle inversely (won if outcome does NOT happen)

## Note on API Quota
- The per-event endpoint requires more quota than sports-level
- API quota was exhausted during development (20003/20000 used)
- The sports-level endpoint does NOT support btts/double_chance/draw_no_bet
- When quota resets, the aggregator will fetch all 14 markets automatically

## Screenshots
All 8 tab screenshots sent to Telegram thread 1836.
