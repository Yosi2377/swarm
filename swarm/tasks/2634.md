# Task 2634 â€” ×‘×“×™×§×•×ª Browser ×¡×¤×¦×™×¤×™×•×ª ×œ×¤×™×¦'×¨

## ×‘×¢×™×”
browser-eval.js ×‘×•×“×§ ×“×‘×¨×™× ×›×œ×œ×™×™× (header ×§×™×™×, ××™×Ÿ JS errors). ×œ× ×‘×•×“×§ ××ª ×”×¤×™×¦'×¨ ×”×¡×¤×¦×™×¤×™ ×©×”×¡×•×›×Ÿ ×¢×‘×“ ×¢×œ×™×•.

## ×¤×ª×¨×•×Ÿ â€” ×¡×•×›× ×™× ×›×•×ª×‘×™× browser tests ×¡×¤×¦×™×¤×™×™×

### 1. ×¢×“×›×Ÿ SYSTEM.md â€” ×—×•×‘×” ×œ×›×ª×•×‘ Browser Tests

```
## ðŸ§ª STEP 2c: WRITE TESTS â€” ×›×•×œ×œ Browser Tests!

×‘-task file, ×”×•×¡×£ ×¡×§×©×Ÿ:

## Browser Tests
- exists: #new-button â†’ "×›×¤×ª×•×¨ ×—×“×© ×§×™×™×"
- click: #new-button â†’ waitFor: .modal â†’ "×œ×—×™×¦×” ×¤×•×ª×—×ª ×ž×•×“×œ"
- text: .result-panel â†’ contains: "×”×¦×œ×—×”" â†’ "×ž×¦×™×’ ×”×•×“×¢×ª ×”×¦×œ×—×”"
- count: .table-row â†’ min: 5 â†’ "×˜×‘×œ×” ×ž×¦×™×’×” ×œ×¤×—×•×ª 5 ×©×•×¨×•×ª"
- type: #search-input â†’ value: "test" â†’ waitFor: .results â†’ "×—×™×¤×•×© ×¢×•×‘×“"

×›×œ ×¤×™×¦'×¨ ×©×”×•×¡×¤×ª = ×œ×¤×—×•×ª ×‘×“×™×§×” ××—×ª.
```

### 2. ×¢×“×›×Ÿ browser-eval.js â€” ×§×¨× tests ×ž-task file

```javascript
// If no test JSON provided, read from task file:
// Parse ## Browser Tests section
// Each line: "- TYPE: SELECTOR â†’ EXPECTED â†’ DESC"
// Convert to test objects and run
```

×”×•×¡×£ ×¤×•× ×§×¦×™×”:
```javascript
function parseTaskTests(taskFile) {
  const content = fs.readFileSync(taskFile, 'utf8');
  const match = content.match(/## Browser Tests\n([\s\S]*?)(?=\n##|\n$|$)/);
  if (!match) return [];
  
  return match[1].split('\n')
    .filter(l => l.trim().startsWith('- '))
    .map(line => {
      // Parse: "- TYPE: SELECTOR â†’ EXPECTED â†’ DESC"
      const parts = line.replace(/^- /, '').split('â†’').map(s => s.trim());
      const [typeSelector, ...rest] = parts;
      const [type, selector] = typeSelector.split(':').map(s => s.trim());
      const desc = rest.pop() || '';
      // Build test object based on type
      return { type, selector, desc, ...parseExpected(rest) };
    });
}
```

### 3. ×¢×“×›×Ÿ evaluator.sh â€” ×©×œ×‘ browser tests ×ž-task file

```bash
# Feature-specific browser tests from task file
TASK_FILE="$SWARM_DIR/tasks/$THREAD.md"
if [ -f "$TASK_FILE" ] && grep -q "## Browser Tests" "$TASK_FILE"; then
  echo "ðŸ§ª Running feature-specific browser tests..."
  FEAT_OUTPUT=$(node "$SWARM_DIR/browser-eval.js" "$URL" --task "$TASK_FILE" 2>&1)
  echo "$FEAT_OUTPUT"
  if echo "$FEAT_OUTPUT" | grep -q "^FAIL"; then
    ERRORS+=("Feature browser tests failed")
  fi
fi
```

## Tests
- node /root/.openclaw/workspace/swarm/browser-eval.js http://95.111.247.22:8090 --task /root/.openclaw/workspace/swarm/tasks/2408.md â†’ runs without crash
- bash -n /root/.openclaw/workspace/swarm/evaluator.sh
- grep -q "Browser Tests" /root/.openclaw/workspace/swarm/SYSTEM.md
