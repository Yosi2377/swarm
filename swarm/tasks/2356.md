# Task 2356 — אכיפת SELF-TEST + screenshots

## הבעיה
סוכנים אומרים "✅ הושלם" בלי לבדוק בפועל ובלי screenshots.

## הפתרון: enforce.sh v2 — חסימה אוטומטית

### 1. guard.sh — בדיקות חובה לפני "done"
עדכן `swarm/guard.sh` (שהחוקר יצר) כדי לבדוק:

```bash
guard.sh pre-done <thread_id>
```
בודק:
- [ ] האם יש screenshots ב-`/tmp/browser-*.png` שנוצרו ב-10 דקות אחרונות?
- [ ] האם ה-sandbox service רץ? (`systemctl is-active sandbox-*`)
- [ ] האם יש git diff ב-sandbox? (אם אין שינויים → לא עבד)
- [ ] האם ה-sandbox URL מחזיר 200?

אם אחד נכשל → מחזיר FAIL + הודעת שגיאה ספציפית.
הסוכן **לא יכול** לדווח "done" בלי PASS.

### 2. עדכון SYSTEM.md — enforce guard.sh
בשלב "Done?" הוסף:
```
guard.sh pre-done <thread_id>
# FAIL? → תתקן ותנסה שוב
# PASS? → עכשיו אפשר לדווח done
```

### 3. Screenshot wrapper — חובה
צור `swarm/screenshot.sh`:
```bash
#!/bin/bash
# screenshot.sh <sandbox_url> <thread_id> <agent_id>
# Opens browser, takes 3 viewport screenshots, sends to Telegram topic
```

הסוכן חייב לקרוא ל-screenshot.sh לפני done.
אם `/tmp/browser-*.png` לא קיימים → guard.sh חוסם.

## קבצים לעדכן
- `swarm/guard.sh` — הוסף pre-done check
- `swarm/screenshot.sh` — חדש
- `swarm/SYSTEM.md` — עדכן workflow step 3-4
