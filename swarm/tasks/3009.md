# Task 3009 — קווים מרובים בשווקים (totals/spreads)

## בעיה
כשפותחים משחק, בשוק Over/Under יש רק קו אחד (2.5) במקום כמה (1.5, 2.5, 3.5).
אותו דבר ל-spreads — רק קו אחד במקום כמה.

## סיבה
`aggregator/src/betsapi.js` שומר רק את הקו הראשון:
```javascript
// שורה 181 — שומר רק ראשון
if (hc.startsWith('O')) { odds.totals.over = val; odds.totals.point = pt; }
```

## מה צריך

### 1. Aggregator — שמור כל הקווים כמערך
ב-`aggregator/src/betsapi.js`:

**לפני:**
```javascript
odds.totals = { over: 1.90, under: 1.90, point: 2.5 }
odds.spreads = { home: 1.85, away: 1.95, homePoint: -0.5, awayPoint: 0.5 }
```

**אחרי:**
```javascript
odds.totals = [
  { point: 0.5, over: 1.10, under: 7.00 },
  { point: 1.5, over: 1.40, under: 2.80 },
  { point: 2.5, over: 1.90, under: 1.90 },
  { point: 3.5, over: 2.60, under: 1.50 },
  { point: 4.5, over: 4.00, under: 1.22 }
]
odds.spreads = [
  { point: -1.5, home: 2.20, away: 1.65 },
  { point: -0.5, home: 1.50, away: 2.50 },
  { point: 0.5, home: 1.85, away: 1.95 },
  { point: 1.5, home: 1.35, away: 3.10 }
]
```

### 2. Frontend — הצג כל הקווים
ב-`public/index.html` ו-`public/live.html`:
- בטבלה הראשית: הצג את הקו הראשי (2.5) כמו עכשיו
- במודל (popup): הצג **כל** הקווים כרשימה
- כל קו = שורה עם Over/Under buttons

### 3. Backend — תמוך במערך
ב-`backend/src/routes/events.js`:
- וודא שה-API מחזיר totals/spreads כמערך
- Backward compat: אם totals הוא object ישן → המר למערך

### 4. Bet placement — שמור את הקו
כשמהמרים על Over 3.5:
- selection: "Over 3.5" (לא סתם "Over")
- odds: הaודס של 3.5 ספציפית

## טכני
⛔ קרא swarm/skills/zozobet-schema.md

**BetsAPI odds format** (from `game_lines.odds`):
```javascript
[
  { name: "1", odds: "1.85", handicap: "-0.5,0" },  // spread home
  { name: "2", odds: "1.95", handicap: "0.5,0" },    // spread away
  { header: "O 2.5", odds: "1.90" },                  // total over
  { header: "U 2.5", odds: "1.90" },                  // total under
  { header: "O 1.5", odds: "1.40" },                  // total over
  { header: "U 1.5", odds: "2.80" },                  // total under
]
```
⚠️ יש כמה entries עם headers שונים — צריך לאסוף את כולם!

## Sandbox
⛔ SANDBOX: /root/sandbox/BettingPlatform
URL: http://95.111.247.22:9089

## Browser Tests
- click: .c-match → waitFor: .modal, .popup, [class*=modal] → "לחיצה על משחק פותחת מודל"
- exists: .c-match → "יש משחקים בדף"
