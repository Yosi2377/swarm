# Task 2536 — שיפור retry — גישה חדשה + למידה מטעויות

## בעיה
כרגע auto-flow מנסה 3 פעמים אותו דבר ואז מוותר. הסוכן לא לומד מהכישלונות.

## פתרון — 2 שלבים של retry

### שלב 1: 3 ניסיונות רגילים (כמו עכשיו)
- סוכן מקבל feedback מ-evaluator
- מנסה לתקן
- evaluator בודק שוב

### שלב 2: 3 ניסיונות עם גישה חדשה (PHASE 2)
אם שלב 1 נכשל:
1. **Reflection** — שאל את הסוכן: "למה נכשלת 3 פעמים? מה הגישה השגויה?"
2. **Learn** — שמור את הטעויות ב-learn.sh
3. **New approach** — שלח לסוכן הודעה חדשה:
   "❌ 3 ניסיונות נכשלו. הטעויות: [list errors]. 
    🔄 נסה גישה אחרת לגמרי. מה עשית עד עכשיו לא עבד.
    💡 רמזים: [past lessons from learn.sh query]"
4. **Different agent option** — אם אותו סוכן נכשל שוב, נסה סוכן אחר
5. 3 ניסיונות נוספים עם הגישה החדשה
6. אם גם זה נכשל → הסלמה ליוסי עם כל ההיסטוריה

### גם תקן:
- evaluator.sh: באג `unbound variable` בשורה 57 — PROJECT_PATHS[$PROJECT]
- auto-flow.sh: הוסף Phase 2 logic

## קבצים
- /root/.openclaw/workspace/swarm/auto-flow.sh
- /root/.openclaw/workspace/swarm/evaluator.sh
- /root/.openclaw/workspace/swarm/retry.sh

## Tests
- bash -n /root/.openclaw/workspace/swarm/auto-flow.sh → no syntax errors
- bash -n /root/.openclaw/workspace/swarm/evaluator.sh → no syntax errors
- /root/.openclaw/workspace/swarm/evaluator.sh 2408 koder → PASS (dashboard test)
- /root/.openclaw/workspace/swarm/test-runner.sh dashboard 2408 → PASS
