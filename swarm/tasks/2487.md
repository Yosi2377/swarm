# Task 2487 — בדיקת הפרדת DB — sandbox vs production

## מטרה
לוודא שה-DB באמת מופרד:
- Production backend (`betting-backend`, port 8089) → DB `betting`
- Sandbox backend (`sandbox-betting-backend`, port 9089) → DB `betting_sandbox`
- Sandbox aggregator חסום ולא רץ
- sync-sandbox-db.sh מעתיק events כל 10 דקות

## Tests
- mongosh --quiet betting --eval "db.events.countDocuments()" → >0
- mongosh --quiet betting_sandbox --eval "db.events.countDocuments()" → >0
- curl -s http://localhost:8089/api/events | python3 -c "import sys,json;d=json.load(sys.stdin);assert len(d)>0, 'empty prod'"
- curl -s http://localhost:9301/api/events | python3 -c "import sys,json;d=json.load(sys.stdin);assert len(d)>0, 'empty sandbox'"
- systemctl is-active sandbox-betting-aggregator | grep -q "failed\|inactive"
- systemctl is-active sandbox-db-sync | grep -q "active"

## בדיקת הפרדה אמיתית
1. הוסף event מזויף ל-betting_sandbox: `mongosh betting_sandbox --eval "db.events.insertOne({testEvent:true, sport:'test', commenceTime:new Date()})"`
2. וודא שהוא לא קיים ב-betting: `mongosh betting --eval "db.events.findOne({testEvent:true})"` → null
3. מחק את ה-test event: `mongosh betting_sandbox --eval "db.events.deleteOne({testEvent:true})"`
4. וודא ש-production API לא השתנה

## Screenshot
צלם את שתי הסביבות:
- http://95.111.247.22:8089 (production)
- http://95.111.247.22:9089 (sandbox)
