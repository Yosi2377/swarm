# Task 2408 â€” ×“××©×‘×•×¨×“ ×¡×˜×˜×•×¡ ×¡×•×›× ×™× + sub-agents ×‘×–××Ÿ ×××ª

## ×‘×¢×™×”
×”×“××©×‘×•×¨×“ ×œ× ××¨××” ××™ ×¢×•×‘×“ ×¢×›×©×™×•, ×¢×œ ××”, ×•×œ× ××¦×™×’ sub-agents.

## ××” ×¦×¨×™×š

### 1. Backend â€” /api/agents/live endpoint ×—×“×©
×§×•×¨× ×-OpenClaw sessions API (sessions_list) ×›×“×™ ×œ×§×‘×œ ×¡×˜×˜×•×¡ ×××™×ª×™:
```bash
# ×©×™××•×© ×‘-openclaw CLI ××• ×§×¨×™××” ×™×©×™×¨×”
# sessions_list ××—×–×™×¨: key, kind, updatedAt, totalTokens, model, messages
```

×”endpoint ××—×–×™×¨:
```json
[
  {
    "id": "koder",
    "name": "×§×•×“×¨",
    "emoji": "âš™ï¸",
    "status": "active",          // active/idle based on updatedAt < 5min ago
    "currentTask": "×ª×™×§×•×Ÿ API",  // from last message or topic name
    "topic": 2374,               // thread ID
    "type": "agent",             // agent or subagent
    "tokens": 35618,             // total tokens used
    "lastActive": "2026-02-15T12:35:00Z",
    "score": 100
  },
  {
    "id": "subagent-abc123",
    "name": "implement-reflection",
    "emoji": "ğŸ”„",
    "status": "active",
    "currentTask": "Reflection + LATS implementation",
    "type": "subagent",
    "tokens": 22000,
    "lastActive": "..."
  }
]
```

### ×›×™×¦×“ ×œ×§×‘×œ sessions:
Option A â€” ×”×¨×¥ openclaw CLI:
```bash
node -e "
const {execSync} = require('child_process');
// Use openclaw internal API or read session files
"
```

Option B â€” ×§×¨× session files ×™×©×™×¨×•×ª:
```bash
ls /root/.openclaw/sessions/  # or wherever sessions are stored
```

Option C â€” ×›×ª×•×‘ endpoint ×‘-server.js ×©×§×•×¨× ×œ-sessions_list API ×¤× ×™××™×ª

### 2. Frontend â€” ×¡×§×©×Ÿ ×¡×•×›× ×™× ×—×™×™×
- ×›×¨×˜×™×¡ ×œ×›×œ ×¡×•×›×Ÿ/sub-agent ×¤×¢×™×œ
- ğŸŸ¢ ×™×¨×•×§ = ×¢×•×‘×“ ×¢×›×©×™×• (updated < 2 ×“×§×•×ª)
- ğŸŸ¡ ×¦×”×•×‘ = ×¢×‘×“ ×œ××—×¨×•× ×” (2-10 ×“×§×•×ª)  
- âš« ××¤×•×¨ = ×œ× ×¤×¢×™×œ
- ××¦×™×’: ×©×, emoji, ××©×™××” × ×•×›×—×™×ª, ×–××Ÿ ×××– ×¢×“×›×•×Ÿ ××—×¨×•×Ÿ, tokens
- sub-agents ××•×¦×’×™× ×‘×¦×‘×¢ ×©×•× ×” / ×¡×§×©×Ÿ × ×¤×¨×“
- Polling ×›×œ 5 ×©× ×™×•×ª

### 3. Activity Feed
- ×¨×©×™××ª ××™×¨×•×¢×™× ×‘×–××Ÿ ×××ª:
  - "âš™ï¸ ×§×•×“×¨ ×”×ª×—×™×œ ×œ×¢×‘×•×“ ×¢×œ #2374"
  - "ğŸ”„ sub-agent implement-reflection ×¡×™×™×"
  - "ğŸ”’ ×©×•××¨ ×‘×•×“×§ ××ª #2306"
- ××§×•×¨: git log + send.sh logs + session changes

## ×§×‘×¦×™×
- Server: /root/.openclaw/workspace/swarm/dashboard/server.js
- Frontend: /root/.openclaw/workspace/swarm/dashboard/public/index.html
- Service: swarm-dashboard

## Browser Tests
- exists: .header â†’ "Header exists"
- text: body â†’ contains: Dashboard â†’ "Shows Dashboard"
- count: .agent-card â†’ min: 1 â†’ "Agent cards visible"

## ×—×•×§×™×
- â›” FEEDBACK LOOP â€” ×›×œ ×©×™× ×•×™ â†’ restart service â†’ curl/browser test â†’ ×ª×§×Ÿ
- â›” guard.sh pre-done ×œ×¤× ×™ ×”×•×©×œ×
- â›” reflect.sh ×œ×¤× ×™ done
